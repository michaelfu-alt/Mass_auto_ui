# 炉温监控程序 - 使用说明

## 快速启动

### 方法1: 双击启动脚本（推荐）
- Windows: 双击 `启动程序.bat` 或 `启动程序.ps1`
- 脚本会自动激活正确的虚拟环境并启动程序

### 方法2: 从命令行启动
```powershell
cd C:\Users\tacti\Desktop\App_Development\Mass_auto_ui
.\venv\Scripts\Activate.ps1
python view\main_ui_test.py
```

## 调试Recipe窗口控件

### 1. 准备工作
- 打开Recipe软件
- 确保 "Recipe: Setup Summary" 窗口可见

### 2. 查看窗口控件
在程序界面中，点击 **"检查窗口"** 按钮：
- ✅ **控制台**会自动打印所有控件的详细信息
- ✅ **界面日志框**会显示检查结果

### 3. 查看详细控件列表
点击 **"列出所有控件"** 按钮：
- 会弹出对话框显示所有控件
- 同时在日志框中也会显示

### 4. 控件信息说明
每个控件会显示以下信息：
```
控件 [0]:
  类型(Type):     Button
  标题(Title):    'Start Once'
  ID:             1
  类名(Class):    Button
  可见(Visible):  True
  启用(Enabled):  True
```

## 控制台输出格式

当您点击"检查窗口"时，控制台会输出类似：

```
================================================================================
窗口标题: Recipe: Setup Summary  (V23.06.00-c)
窗口类名: #32770
================================================================================
窗口的所有子控件:
--------------------------------------------------------------------------------
总共找到 X 个子控件

控件 [0]:
  类型(Type):     Button
  标题(Title):    'Start Once'
  ID:             1
  类名(Class):    Button
  可见(Visible):  True
  启用(Enabled):  True
--------------------------------------------------------------------------------
控件 [1]:
  类型(Type):     Button
  标题(Title):    'Cancel'
  ID:             2
  类名(Class):    Button
  可见(Visible):  True
  启用(Enabled):  True
--------------------------------------------------------------------------------
...
================================================================================
```

## 查找按钮信息

程序会尝试 4 种方式查找 "Start Once" 按钮：
1. 通过 control_id=1 + class_name="Button"
2. 通过 title="Start Once" + class_name="Button"
3. 只通过 title="Start Once"
4. 只通过 control_id=1

如果这些方法都失败，请：
1. 点击"列出所有控件"
2. 在控件列表中找到 "Start Once" 按钮
3. 记录它的真实属性（Title、ID、Class）
4. 反馈给开发者进行代码调整

## 虚拟环境说明

程序使用的虚拟环境：
- **路径**: `C:\Users\tacti\Desktop\App_Development\Mass_auto_ui\venv`
- **Python版本**: 3.14.0

已安装的关键包：
- PySide6 (GUI界面)
- PyQt5 (pywinauto需要)
- pywinauto (Windows自动化)
- pyserial (串口通信)

## 常见问题

### Q: 找不到Recipe窗口？
A: 
1. 确保Recipe软件已打开
2. 确保窗口标题包含 "Recipe: Setup Summary"
3. 窗口不能被最小化

### Q: 找到窗口但未找到按钮？
A:
1. 点击"列出所有控件"查看详细信息
2. 在控制台查看完整的控件列表
3. 确认按钮的真实属性

### Q: 程序启动失败？
A:
1. 使用 `启动程序.bat` 或 `启动程序.ps1` 启动
2. 确保虚拟环境已正确安装所有依赖
3. 运行 `.\venv\Scripts\pip install -r requirements.txt` 重新安装依赖

## 技术支持

如果遇到问题，请提供：
1. 控制台输出的完整控件列表
2. 错误信息截图
3. Recipe软件的窗口标题完整内容

